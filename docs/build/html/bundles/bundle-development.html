
<!DOCTYPE html>

<html lang="y">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bundle Development &#8212; Harmony 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="bundle-development">
<h1>Bundle Development<a class="headerlink" href="#bundle-development" title="Permalink to this headline">¶</a></h1>
<div class="section" id="developing-a-openharmony-bundle">
<h2>Developing a OpenHarmony Bundle<a class="headerlink" href="#developing-a-openharmony-bundle" title="Permalink to this headline">¶</a></h2>
<p>You have an option to use any of the following methods to develop an
OpenHarmony bundle:</p>
<ul class="simple">
<li><p>Develop a brand new bundle from scratch.</p></li>
<li><p>Rewrite code of an existing non-bundle to develop a bundle.</p></li>
<li><p>Use HPM-provided bundle templates to quickly develop a bundle.</p></li>
</ul>
</div>
<div class="section" id="creating-a-bundle">
<h2>Creating a Bundle<a class="headerlink" href="#creating-a-bundle" title="Permalink to this headline">¶</a></h2>
<p>Generally, you can find commonly used bundles on the
<a class="reference external" href="https://hpm.harmonyos.com/#/en/home">HPM</a> website. If they cannot
meet your requirements, you can develop your own bundles.</p>
<p>You can publish bundles in the HPM repository if you like, so that your
peers have an option to use them. Assume that you want to create a
bundle named <strong>my-bundle</strong> in the <strong>D:/source</strong> directory:</p>
<p>Run the <strong>hpm init</strong> command to create the scaffold code for this
bundle. For example, you can go to the <strong>D:/source</strong> directory and run
the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hpm</span> <span class="n">init</span> <span class="o">-</span><span class="n">t</span> <span class="n">default</span>  <span class="o">-</span><span class="n">d</span> <span class="n">demo</span> <span class="n">my</span><span class="o">-</span><span class="n">bundle</span>
</pre></div>
</div>
<p>The following files are generated in the <strong>source</strong> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mybundle
├── bundle.json      # Metadata description file of the bundle
├── example          # Example of testing bundle functions
│   └── main.c
├── include            # Internal header files of the bundle
│   └── mybundle.h
├── README.md        # Brief description of the bundle
└── src              # Source code of the bundle
     └─ mybundle.c
</pre></div>
</div>
<p>Then, complete your coding based on service requirements. Finally, use
<strong>git</strong> to commit your code (including the <strong>bundle.json</strong> file) to the
code hosting repository, such as gitee.</p>
</div>
<div class="section" id="modifying-a-bundle">
<h2>Modifying a Bundle<a class="headerlink" href="#modifying-a-bundle" title="Permalink to this headline">¶</a></h2>
<p>If you have code unqualified for the OpenHarmony bundle structure,
modify your code to match an HPM bundle. In the code directory (for
example, <strong>mybundle2</strong>) storing your code, run the following command
with the bundle name and version specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hpm</span> <span class="n">init</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>Enter a bundle name (<strong>mybundle2</strong> as an example) and press
<strong>Enter</strong>.</p></li>
<li><p>Enter the bundle version (<strong>1.0.0</strong> as an example) and press
<strong>Enter</strong>. A <strong>bundle.json</strong> file is generated in the current bundle
directory.</p></li>
<li><p>Add other descriptions in <strong>bundle.json</strong>, which is publishable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ hpm init
Your bundle will be created in dirname E:\demo\mybundle2
? bundle name mybundel2
? version 1.0.0
Init finished!
</pre></div>
</div>
</li>
<li><p>Modify other information (such as the author, code repository, code
directory, command script, and dependent bundles) in <strong>bundle.json</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;mybundle2&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="s2">&quot;publishAs&quot;</span><span class="p">:</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
<span class="s2">&quot;dirs&quot;</span><span class="p">:{</span>
<span class="s2">&quot;.&quot;</span><span class="p">:[</span>
<span class="s2">&quot;README.md&quot;</span>
    <span class="p">],</span>
<span class="s2">&quot;src&quot;</span><span class="p">:[</span>
<span class="s2">&quot;test.c&quot;</span>
    <span class="p">],</span>
<span class="s2">&quot;header&quot;</span><span class="p">:[</span>
<span class="s2">&quot;header/test.h&quot;</span>
    <span class="p">],</span>
<span class="s2">&quot;src/common&quot;</span><span class="p">:[</span>
<span class="s2">&quot;src/common/foobar.txt&quot;</span>
    <span class="p">]</span>
  <span class="p">},</span>
<span class="s2">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;build&quot;</span><span class="p">:</span> <span class="s2">&quot;make -$</span><span class="si">{args}</span><span class="s2">&quot;</span>
  <span class="p">},</span>
<span class="s2">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;@ohos/cjson&quot;</span><span class="p">:</span> <span class="s2">&quot;^1.0.0&quot;</span><span class="p">,</span>
<span class="s2">&quot;@ohos/&quot;</span><span class="p">:</span> <span class="s2">&quot;^1.2.0&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="using-hpm-provided-template-to-create-a-bundle">
<h2>Using HPM-provided Template to Create a Bundle<a class="headerlink" href="#using-hpm-provided-template-to-create-a-bundle" title="Permalink to this headline">¶</a></h2>
<p>The HPM provides <strong>default</strong> and <strong>simple</strong> templates as well as other
templates that are stored on the server.</p>
<p>You can run the <strong>hpm search -t template</strong> command to search for a
template stored on the server.</p>
<p><img alt="image1" src="../_images/en-us_image_0000001051452177.png" /></p>
<p>Then, select your desired template based on the information below
<strong>description</strong>, use the selected template to quickly create the bundle
scaffold, and run the following command with the <strong>-t</strong> and <strong>-d</strong>
parameters specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hpm</span> <span class="n">init</span> <span class="o">-</span><span class="n">t</span> <span class="p">{</span><span class="n">templatename</span><span class="p">}</span> <span class="o">-</span><span class="n">d</span> <span class="nb">dir</span> <span class="n">name</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>{templatename}</strong> indicates the template name.</p></li>
<li><p><strong>dir</strong> indicates the path for storing the bundle to be created.</p></li>
<li><p><strong>name</strong> indicates the name of the bundle to be created.</p></li>
</ul>
</div>
<div class="section" id="building-a-bundle">
<h2>Building a Bundle<a class="headerlink" href="#building-a-bundle" title="Permalink to this headline">¶</a></h2>
<p>After completing code development, you need to build the bundle. The HPM
supports command integration so that you can select any build tool (such
as <strong>make</strong>, <strong>gcc</strong>, and <strong>gn</strong>) suitable for your project. You only
need to define the <strong>build</strong> command in the <strong>scripts</strong> in the
<strong>bundle.json</strong> file of your project, and then you run the hpm command
<strong>build</strong> to perform building.</p>
</div>
<div class="section" id="defining-the-building-script">
<h2>Defining the Building Script<a class="headerlink" href="#defining-the-building-script" title="Permalink to this headline">¶</a></h2>
<p>This section uses how to build an executable file <strong>helloworld</strong> in the
<strong>app</strong> directory as an example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>app
├── BUILD.gn
├── include
│   └── helloworld.h
└── src
    └── helloworld.c
</pre></div>
</div>
<p>Create a <strong>BUILD.gn</strong> file in the same directory as <strong>helloworld.c</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">touch</span> <span class="n">BUILD</span><span class="o">.</span><span class="n">gn</span>
<span class="n">vim</span> <span class="n">BUILD</span><span class="o">.</span><span class="n">gn</span>
</pre></div>
</div>
<p>The following is an example of <strong>BUILD.gn</strong> for your reference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">executable</span><span class="p">(</span><span class="s2">&quot;hello_world&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;src/helloworld.c&quot;</span>
    <span class="p">]</span>

    <span class="n">include_dirs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;include&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p><img alt="image2" src="../_images/icon-note.gif" /> <strong>NOTE:</strong> - <strong>executable</strong> is a built-in template of <strong>gn</strong>.
You can run the <strong>gn help executable</strong> command to view how to use
this template. - <strong>sources</strong> represents the source code path, and
<strong>include_dirs</strong> represents the header file path.</p>
</div></blockquote>
</div>
<div class="section" id="executing-the-building-script">
<h2>Executing the Building Script<a class="headerlink" href="#executing-the-building-script" title="Permalink to this headline">¶</a></h2>
<p>Run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hpm</span> <span class="n">build</span>
</pre></div>
</div>
<p>After all building operations are complete, the message “build succeed”
is displayed. You need to check the building result.</p>
<p><img alt="image3" src="../_images/en-us_image_0000001051770876.png" /></p>
</div>
<div class="section" id="defining-a-distribution">
<h2>Defining a Distribution<a class="headerlink" href="#defining-a-distribution" title="Permalink to this headline">¶</a></h2>
<p>A distribution refers to an image file of an executable OpenHarmony
solution composed of a group of bundles. It contains many dependent
bundles and provides scripts to illustrate how to compile and link these
bundles.</p>
</div>
<div class="section" id="defining-scripts">
<h2>Defining Scripts<a class="headerlink" href="#defining-scripts" title="Permalink to this headline">¶</a></h2>
<p>Define scripts in <strong>bundle.json</strong> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my_dist&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="s2">&quot;publishAs&quot;</span><span class="p">:</span> <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<span class="s2">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;dist&quot;</span><span class="p">:</span> <span class="s2">&quot;make -$</span><span class="si">{args}</span><span class="s2">&quot;</span>
  <span class="p">},</span>
<span class="s2">&quot;base&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;dist-bundle&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span>
  <span class="p">},</span>
<span class="s2">&quot;envs&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="s2">&quot;x86&quot;</span>
  <span class="p">},</span>
<span class="s2">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="distributing">
<h2>Distributing<a class="headerlink" href="#distributing" title="Permalink to this headline">¶</a></h2>
<p>Run the following command in the current distribution directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hpm</span> <span class="n">dist</span>
</pre></div>
</div>
<p>The <strong>hpm-cli</strong> tool automatically performs compiling and packing, and
generates an image file of the <strong>dist</strong> script defined based on
<strong>scripts</strong>. The following is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">out</span>
<span class="o">|-</span><span class="n">xxdist</span><span class="o">.</span><span class="n">img</span>
<span class="o">|-</span><span class="n">xx</span><span class="o">.</span><span class="n">file</span>
</pre></div>
</div>
</div>
<div class="section" id="burning">
<h2>Burning<a class="headerlink" href="#burning" title="Permalink to this headline">¶</a></h2>
<p>The building result of the distribution can be burnt into devices, for
example, by using the <strong>hiburn</strong> tool. You need to configure burning
parameters in the <strong>bundle.json</strong> file of the distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;flash&quot;</span><span class="p">:</span> <span class="s2">&quot;{$DEP_HIBURN}/hiburn&quot;</span>
<span class="p">},</span>
</pre></div>
</div>
<p>You should set burning parameters by referring to the specific guide on
the burning tool you use.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hpm</span> <span class="n">run</span> <span class="n">flash</span>
</pre></div>
</div>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>Start debugging after you have burnt the image file of the distribution
into devices. The debugging process varies according to specific
development boards and IDE debugging tools.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Harmony</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Arul.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/bundles/bundle-development.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>