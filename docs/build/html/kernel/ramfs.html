
<!DOCTYPE html>

<html lang="y">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RAMFS &#8212; Harmony 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="ramfs">
<h1>RAMFS<a class="headerlink" href="#ramfs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>RAMFS is a RAM-based file system whose size can be dynamically adjusted.
RAMFS does not have a backup storage source. Directory entries and page
caches are allocated when files are written into RAMFS. However, data is
not written back to any other storage medium, and data is lost after a
power outage.</p>
<p>RAMFS stores all files in RAM, and read/write operations are performed
in RAM. RAMFS is generally used to store temporary data or data that
needs to be frequently modified, such as the <strong>/tmp</strong> and <strong>/var</strong>
directories. Using RAMFS reduces the read/write loss of the memory and
improves the data read/write speed.</p>
<p>RAMFS in the OpenHarmony kernel is a simple file system and provides a
storage buffer for RAM-based dynamic file systems.</p>
<p>RAMFS in the OpenHarmony kernel is based on VFS and cannot be formatted.</p>
</div>
<div class="section" id="important-notes">
<h2>Important Notes<a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The read and write pointers of RAMFS are not separated. Therefore,
after a file is opened in <strong>O_APPEND</strong> mode, the read pointer is also
at the end of the file. You must manually set the position of the
read pointer before reading the file.</p></li>
<li><p>A RAMFS file system can be mounted only once. After it is mounted to
a directory, it cannot be mounted to other directories.</p></li>
<li><p>The number of RAMFS files is restricted by semaphore resources and
cannot exceed the value of <strong>LOSCFG_BASE_IPC_SEM_LIMIT</strong>.</p></li>
<li><p>When you use <strong>open</strong> with the parameter <strong>O_TRUNC</strong> to open a file,
the file content will be cleared.</p></li>
<li><p>You can perform the following operation on RAMFS files: <strong>open</strong>,
<strong>close</strong>, <strong>read</strong>, <strong>write</strong>, <strong>seek</strong>, <strong>opendir</strong>, <strong>closedir</strong>,
<strong>readdir</strong>, <strong>readdir_r</strong>, <strong>rewinddir</strong>, <strong>sync</strong>, <strong>statfs</strong>,
<strong>remove</strong>, <strong>unlink</strong>, <strong>mkdir</strong>, <strong>rmdir</strong>, <strong>rename</strong>, <strong>stat</strong>,
<strong>stat64</strong>, <strong>seek64</strong>, <strong>mmap</strong>, <strong>mount</strong>, and <strong>umount</strong>.</p></li>
<li><p>RAMFS is under debugging and disabled by default. Do not use it in
formal products.</p></li>
</ul>
</div>
<div class="section" id="development-guidelines">
<h2>Development Guidelines<a class="headerlink" href="#development-guidelines" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Initialize a RAMFS file system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">ram_fs_init</span><span class="p">(</span><span class="n">void</span><span class="p">)</span> <span class="p">{</span>
     <span class="nb">int</span> <span class="n">swRet</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
     <span class="n">swRet</span> <span class="o">=</span> <span class="n">mount</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">RAMFS_DIR</span><span class="p">,</span> <span class="s2">&quot;ramfs&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">swRet</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">dprintf</span><span class="p">(</span><span class="s2">&quot;mount ramfs err </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">swRet</span><span class="p">);</span>
         <span class="k">return</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="n">dprintf</span><span class="p">(</span><span class="s2">&quot;Mount ramfs finished.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>If the following information is displayed during the startup of the
OpenHarmony kernel, the RAMFS file system is initialized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Mount</span> <span class="n">ramfs</span> <span class="n">finished</span>
</pre></div>
</div>
</li>
<li><p>Mount the RAMFS file system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OHOS</span> <span class="c1"># mount 0 /ramfs ramfs</span>
</pre></div>
</div>
<p>If the following information is displayed, the RAMFS file system is
mounted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OHOS</span> <span class="c1"># mount 0 /ramfs ramfs</span>
<span class="n">mount</span> <span class="n">ok</span>
</pre></div>
</div>
</li>
<li><p>Unmount the RAMFS file system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OHOS</span> <span class="c1"># umount /ramfs</span>
</pre></div>
</div>
<p>If the following information is displayed, the RAMFS file system is
unmounted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OHOS</span> <span class="c1"># umount /ramfs</span>
<span class="n">umount</span> <span class="n">ok</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Harmony</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Arul.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/kernel/ramfs.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>