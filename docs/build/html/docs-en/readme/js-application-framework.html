
<!DOCTYPE html>

<html lang="y">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JS Application Framework &#8212; Harmony 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="js-application-framework">
<h1>JS Application Framework<a class="headerlink" href="#js-application-framework" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The JS application framework allows you to develop web-like applications
across platforms. The framework uses Toolkit to pack your <strong>.hml</strong>,
<strong>.css</strong>, and <strong>.js</strong> files to a JavaScript bundle, parses the bundle,
generates the native UI view component tree, and then renders it for
display. You can use the declarative APIs to develop applications. This
allows data to drive view changes and avoids a large number of view
operations, greatly simplifying application development.</p>
<p>The following figure shows the framework modules.</p>
<p><img alt="image1" src="../../_images/js-framework.png" /></p>
</div>
<div class="section" id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h2>
<p>The source code of the framework is stored in <strong>/foundation/ace</strong>. The
following shows the directory structure.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/foundation/ace
├── frameworks # Framework code
│   └── lite
│       ├── examples # Sample code
│       ├── include # Exposed header files
│       ├── packages # JavaScript implementation
│       ├── src # Source code
│       ├── targets # Configuration file of each target device
│       └── tools # Tool code
├── interfaces # APIs exposed externally
│   └── innerkits # Header files of internal subsystems
│       └── builtin # JavaScript third-party module APIs exposed by the JS application framework
</pre></div>
</div>
</div>
<div class="section" id="constraints">
<h2>Constraints<a class="headerlink" href="#constraints" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Language versions:</p>
<ul>
<li><p>C++11 or later</p></li>
<li><p>JavaScript ES5.1</p></li>
</ul>
</li>
<li><p>Framework runtime memory consists of:</p>
<ul>
<li><p>Runtime memory for the JavaScript engine: The memory size is
adjustable and depends on the complexity of the device
application. Generally, 64 KB to 512 KB is recommended.</p></li>
<li><p>Native memory for the framework itself: For devices whose memory
capacity exceeds 100 KB, it is recommended that a pre-allocated
memory pool be used for native memory management. The memory pool
is shared with the native UI framework.</p></li>
</ul>
</li>
<li><p>The framework provides different specifications for various chip
platforms and underlying OS capabilities:</p>
<ul>
<li><p>Cortex-M RAM and ROM</p>
<ul>
<li><p>JavaScript engine memory pool: greater than 48 KB (recommended)</p></li>
<li><p>RAM: memory pool shared with the native UI (recommended). The
size must be greater than 80 KB.</p></li>
<li><p>ROM: greater than 300 KB (for the JS application framework and
related subsystems, such as native UI and JavaScript engine)</p></li>
</ul>
</li>
<li><p>Cortex-A RAM and ROM</p>
<ul>
<li><p>JavaScript engine memory pool: greater than 128 KB
(recommended)</p></li>
<li><p>RAM: greater than 512 KB (recommended)</p></li>
<li><p>ROM: greater than 2 MB (for the JS application framework and
related subsystems, such as native UI and JavaScript engine)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="using-targets">
<h2>Using targets<a class="headerlink" href="#using-targets" title="Permalink to this headline">¶</a></h2>
<p>The implementation of the JS application framework consists of the
following two parts:</p>
<ul class="simple">
<li><p>Native part: The native part is developed in C++ and is the main body
of the framework.</p></li>
<li><p>JavaScript part: The JavaScript part supports the runtime environment
of JavaScript files, and supports the interaction between the
JavaScript runtime and native framework through some global functions
or objects exposed to the JavaScript engine.</p></li>
</ul>
<p>The framework uses feature macros to customize function code to be
compiled on different platforms. The feature macros are stored in header
files in <strong>foundation/ace/frameworks/lite/targets</strong>. The directory
structure is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/foundation/ace/frameworks/lite/targets
├── default/
│   └── acelite_config.h
├── linux/ # Linux environment configuration files
│   └── acelite_config.h
├── liteos_a/ # Environment configuration files for LiteOS Cortex-A
│   └── acelite_config.h
├── liteos_m/ # Environment configuration files for LiteOS Cortex-M
│   └── acelite_config.h
├── platform_adapter.cpp
├── platform_adapter.h
└── simulator/ # Simulator environment configuration files
    └── win/
        └── acelite_config.h*
</pre></div>
</div>
<p>Note: Currently only the target compilation for LiteOS Cortex-A is
open-source, which is built using Ninja (BUILD.g). Other targets such as
simulat (CMake+MingW), Linux(Ninja), and LiteOS Cortex-M (IAR) are not
completely open and will be gradually released after the adaptation is
complete. The following examples describe the role of the <strong>targets</strong>
directory in building different targets.</p>
<p>When compiling for different platform targets, use the
<strong>acelite_config.h</strong> file in the corresponding platform directory. You
can configure the header file searching path for compilation to locate
the file to use. The following takes <strong>ninja</strong> and <strong>cmake</strong> build tools
as examples:</p>
<ul>
<li><p><strong>ninja</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">ohos_kernel_type</span> <span class="o">==</span> <span class="s2">&quot;liteos_a&quot;</span> <span class="o">||</span> <span class="n">ohos_kernel_type</span><span class="o">==</span> <span class="s2">&quot;liteos_m&quot;</span> <span class="o">||</span>
    <span class="n">ohos_kernel_type</span> <span class="o">==</span> <span class="s2">&quot;liteos_riscv&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="o">//</span> <span class="n">Select</span> <span class="n">different</span> <span class="n">header</span> <span class="n">file</span> <span class="n">searching</span> <span class="n">paths</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">target</span> <span class="n">kernel</span> <span class="n">platform</span><span class="o">.</span>
  <span class="n">include_dirs</span> <span class="o">+=</span> <span class="p">[</span> <span class="s2">&quot;targets/liteos-a&quot;</span> <span class="p">]</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ohos_kernel_type</span> <span class="o">==</span> <span class="s2">&quot;linux&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">include_dirs</span> <span class="o">+=</span> <span class="p">[</span> <span class="s2">&quot;targets/linux&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>cmake</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>......
set(ACE_LITE_CONFIG_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/targets/simulator/win&quot;) # Set the simulator search path to targets/simulator/win.
set(JSFWK_INCLUDE_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/include&quot;)
set(JSFWK_SOURCE_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/src/core&quot;)
set(UIKIT_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/../ui&quot;)
set(THIRTY_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/../../../third_party&quot;)
set(JSFWK_SIMULATOR_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/../tools/simulator&quot;)
set(JS_API_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/../../api/emui_band/MoltenCore/application/framework/ace/api&quot;)
set(JSFWK_SIMULATOR_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/../tools/simulator&quot;)
set(AAFWK_PATH &quot;${CMAKE_CURRENT_SOURCE_DIR}/../../../aafwk&quot;)

# header files
include_directories(
    ${ACE_LITE_CONFIG_PATH}
    ${JSFWK_INCLUDE_PATH}/async
    ${JSFWK_INCLUDE_PATH}/base
    ${JSFWK_INCLUDE_PATH}/context
    ${JSFWK_INCLUDE_PATH}/jsi
    ${JSFWK_SOURCE_PATH}
    ......
</pre></div>
</div>
</li>
</ul>
<p>The <strong>acelite_config.h</strong> file is used to enable or disable the feature
macros of different platforms. It can also be used to define constants
for shielding platform differences. For example, platform file systems
are different, and the names of some fixed directories might be
different. These constants can be defined as follows:</p>
<ul>
<li><p><strong>liteos-a/acelite_config.h</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define JS_FRAMEWORK_PATH &quot;//system/ace/bin/&quot;</span>
</pre></div>
</div>
</li>
<li><p><strong>simulator/win/acelite_config.h</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define JS_FRAMEWORK_PATH &quot;..\\..\\..\\jsfwk\\packages\\runtime-core\\build&quot;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="using-runtime-core">
<h2>Using Runtime-core<a class="headerlink" href="#using-runtime-core" title="Permalink to this headline">¶</a></h2>
<p>Runtime-core is a JavaScript-based simple data hijacking framework
provided by the JS application framework to implement unidirectional
data binding. The directory structure is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/foundation/ace/frameworks/lite/packages
└── runtime-core
    ├── .babelrc # Babel configuration file
    ├── .editorconfig # IDE configuration file
    ├── .eslintignore # Configuration file of the ESLint tool. You can set a directory or files that will not be scanned by the ESLint tool.
    ├── .eslintrc.js # ESLint configuration file for scanning rules
    ├── .gitignore
    ├── package.json # NPM file
    ├── package-lock.json # NPM dependency lock file
    ├── .prettierrc # Configuration file for code formatting rules
    ├── scripts # Directory for compilation scripts
    │   ├── build.js # Compilation script
    │   └── configs.js # Rollup configuration file
    ├── .size-snapshot.json
    └── src # Source code
        ├── core # ViewModel core implementation code
        │   └── index.js
        ├── index.js
        ├── observer # Data hijacking implementation code
        │   ├── index.js
        │   ├── observer.js
        │   ├── subject.js
        │   └── utils.js
        ├── profiler # profiler directory
        │   └── index.js
        └── __test__ # Test cases
            └── index.test.js
</pre></div>
</div>
<p>The following NPM commands are supported:</p>
<ul>
<li><p><strong>npm run build</strong></p>
<p>The JavaScript engine integrated in the JS application framework
supports ES5.1 syntax only. However, the runtime-core is implemented
using JavaScript ES6. Therefore, you should use Babel for syntax
degradation and use Rollup to package the code. Run the <strong>npm run
build</strong> command, and the packaged files are output to the <strong>build</strong>
directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>build/
├── framework-dev.js // Framework code used in the development environment (uncompressed and obfuscated)
├── framework-dev.min.js // Framework code used in the development environment (compressed and obfuscated)
├── framework-dev.js // Framework code used in the production environment (uncompressed and obfuscated)
├── framework-dev.min.js // Framework code used in the production environment (compressed and obfuscated)
</pre></div>
</div>
</li>
<li><p><strong>npm run test</strong></p>
<p>Runtime-core uses Jest for unit testing. Run the <strong>npm run test</strong>
command to start the unit test.</p>
</li>
</ul>
</div>
<div class="section" id="repositories-involved">
<h2>Repositories Involved<a class="headerlink" href="#repositories-involved" title="Permalink to this headline">¶</a></h2>
<p>ace_lite_jsfwk</p>
<p>ace_interfaces_innerkits_builtin</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Harmony</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Arul.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/docs-en/readme/js-application-framework.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>