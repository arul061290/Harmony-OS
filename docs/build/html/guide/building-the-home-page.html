
<!DOCTYPE html>

<html lang="y">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Building the Home Page &#8212; Harmony 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="building-the-home-page">
<h1>Building the Home Page<a class="headerlink" href="#building-the-home-page" title="Permalink to this headline">¶</a></h1>
<p>The application home page displays air quality information of the
current city. There are two screens on the home page. Each screen
displays air quality information of a city, including the AQI and city
name. The AQI value can be displayed in the form of a ring progress bar
with animation.</p>
<ol class="arabic">
<li><p>The <strong>&lt;swiper&gt;</strong> component is required to implement the switch
between the two screens.</p>
<p>Add a root <strong>&lt;swiper&gt;</strong> to the <strong>.hml</strong> file. Note that each <strong>.hml</strong>
file can contain only one root component. The code snippet is as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">swiper</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;container&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;left:253px;&quot;</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;{{swiperPage}}&quot;</span> <span class="n">duration</span><span class="o">=</span><span class="s2">&quot;500&quot;</span> <span class="n">onchange</span><span class="o">=</span><span class="s2">&quot;swiperChange&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">swiper</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul>
<li><p><strong>class=“container”</strong> indicates the style used by the component.
The <strong>container</strong> is a style class in the <strong>index.css</strong> file. The
code snippet is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">container</span><span class="p">{</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">454</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This style class sets the height and width of the component.
During application development, the component height and width
must be explicitly specified. Otherwise, the component may fail to
be displayed.</p>
</li>
<li><p><strong>index=“{{swiperPage}}” duration=“500” onchange=“swiperChange”</strong>
sets the component attribute and event. <strong>duration=“500”</strong>
indicates that the duration of the swiping animation is 500 ms.</p></li>
<li><p><strong>index=“{{swiperPage}}”</strong> specifies the index of the child
component of <strong>&lt;swiper&gt;</strong>. <strong>{{swiperPage}}</strong> indicates that the
index value is dynamically bound to the <strong>swiperPage</strong> variable in
the JavaScript code. The index value changes with the
<strong>swiperPage</strong> value.</p></li>
<li><p><strong>onchange=“swiperChange”</strong> binds the change event of the
<strong>&lt;swiper&gt;</strong> component to the <strong>swiperChange</strong> function. The
JavaScript code is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Import</span> <span class="n">the</span> <span class="n">router</span> <span class="n">module</span> <span class="k">for</span> <span class="n">page</span> <span class="n">switching</span><span class="o">.</span>
<span class="kn">import</span> <span class="nn">router</span> <span class="n">from</span><span class="s1">&#39;@system.router&#39;</span>
<span class="n">export</span> <span class="n">default</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">Define</span> <span class="n">parameters</span><span class="o">.</span>
    <span class="n">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="n">swiperPage</span><span class="p">:</span><span class="mi">0</span> <span class="o">//</span> <span class="n">The</span> <span class="n">first</span> <span class="n">page</span> <span class="ow">is</span> <span class="n">displayed</span> <span class="n">by</span> <span class="n">default</span><span class="o">.</span>
    <span class="p">},</span>
    <span class="n">onInit</span> <span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="o">//</span> <span class="n">Swiping</span> <span class="n">event</span><span class="p">,</span> <span class="n">which</span> <span class="n">saves</span> <span class="n">the</span> <span class="n">index</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">current</span> <span class="o">&lt;</span><span class="n">swiper</span><span class="o">&gt;.</span> <span class="n">The</span> <span class="n">index</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">saved</span> <span class="n">to</span> <span class="n">the</span> <span class="n">swiperPage</span> <span class="n">variable</span> <span class="n">each</span> <span class="n">time</span> <span class="n">a</span> <span class="n">swiping</span> <span class="n">occurs</span><span class="o">.</span>
    <span class="n">swiperChange</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">this</span><span class="o">.</span><span class="n">swiperPage</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Set the information about each city to be displayed on a screen. In
each screen, four types of information need to be displayed using
different components.</p>
<p>Add two child components (<strong>&lt;stack&gt;</strong>) to the <strong>&lt;swiper&gt;</strong>. Add the
<strong>&lt;text&gt;</strong>, <strong>&lt;image&gt;</strong>, and <strong>&lt;progress&gt;</strong> components to each
<strong>&lt;stack&gt;</strong> to display the information. Code example in the <strong>.hml</strong>
file is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;!-- The root component is &lt;swiper&gt;. Only one root component is supported. --&gt;
 &lt;swiper class=&quot;container&quot; style=&quot;left:253px;&quot; index=&quot;{{swiperPage}}&quot; duration=&quot;500&quot; onchange=&quot;swiperChange&quot;&gt;
    &lt;!-- The first screen --&gt;
    &lt;stack class=&quot;container&quot;&gt;
        &lt;text&gt;&lt;/text&gt;------City
         &lt;text&gt;&lt;/text&gt;------Air quality
        &lt;progress&gt;&lt;/progress&gt;-----Progress bar
        &lt;image&gt;&lt;/image&gt;-------A cloud image
        &lt;text&gt;&lt;/text&gt;--------AQI value
        &lt;text&gt;AQI&lt;/text&gt;------AQI
    &lt;/stack&gt;
     &lt;!-- The second screen --&gt;
    &lt;stack class=&quot;container&quot;&gt;
        &lt;text&gt;&lt;/text&gt;
        &lt;text&gt;&lt;/text&gt;
        &lt;progress&gt;&lt;/progress&gt;
        &lt;image&gt;&lt;/image&gt;
        &lt;text&gt;&lt;/text&gt;
        &lt;text&gt;&lt;/text&gt;
    &lt;/stack&gt;
&lt;/swiper&gt;
</pre></div>
</div>
</li>
<li><p>Set the style, animation effect, and dynamic data binding for all
components. The complete example code is as follows:</p>
<ul class="simple">
<li><p><strong>index.hml</strong></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;!-- The root component is &lt;swiper&gt;. Only one root component is supported. --&gt;
 &lt;swiper class=&quot;container&quot; style=&quot;left:253px;&quot; index=&quot;{{swiperPage}}&quot; duration=&quot;500&quot; onchange=&quot;swiperChange&quot;&gt;
    &lt;!-- The first screen --&gt;
    &lt;stack class=&quot;container&quot;&gt;
        &lt;!-- Display air quality and current city --&gt;
        &lt;text class=&quot;airquality&quot; style=&quot;color:{{textColor1}};&quot;&gt;{{airData[0].airQuality}}&lt;/text&gt;
        &lt;text class=&quot;location-text&quot;&gt;{{airData[0].location}}&lt;/text&gt;
        &lt;!-- Display the animation effect based on the AQI value. To achieve this, you need to implement dynamic percent1 value changes in the .js file.--&gt;
        &lt;progress class=&quot;circleProgress&quot;style=&quot;color:{{textColor1}};background-Color:{{bgColor1}};&quot;type=&quot;arc&quot;onclick=&quot;openDetail&quot;percent=&quot;{{percent1}}&quot;&gt;&lt;/progress&gt;
        &lt;image class=&quot;image&quot;src=&quot;{{src1}}&quot;&gt;&lt;/image&gt;
        &lt;!-- AQI, which is obtained dynamically --&gt;
        &lt;text class=&quot;pm25-value&quot;&gt;{{airData[0].detailData}}&lt;/text&gt;
        &lt;text class=&quot;pm25-name&quot;&gt;AQI&lt;/text&gt;
    &lt;/stack&gt;
    &lt;!-- The second screen --&gt;
    &lt;stack class=&quot;container&quot;&gt;
        &lt;text class=&quot;airquality&quot;style=&quot;color:{{textColor2}};&quot;&gt;{{airData[1].airQuality}}&lt;/text&gt;
        &lt;text class=&quot;location-text&quot;&gt;{{airData[1].location}}&lt;/text&gt;
        &lt;progress class=&quot;circleProgress&quot;style=&quot;color: {{textColor2}};background-Color:{{bgColor2}};&quot;type=&quot;arc&quot;onclick=&quot;openDetail&quot;percent=&quot;{{percent2}}&quot;&gt;&lt;/progress&gt;
        &lt;image class=&quot;image&quot;src=&quot;{{src2}}&quot;&gt;&lt;/image&gt;
        &lt;text class=&quot;pm25-value&quot;&gt;{{airData[1].detailData}}&lt;/text&gt;
        &lt;text class=&quot;pm25-name&quot;&gt;AQI&lt;/text&gt;
    &lt;/stack&gt;
&lt;/swiper&gt;
</pre></div>
</div>
<ul class="simple">
<li><p><strong>index.css</strong></p></li>
</ul>
<p>A <strong>.css</strong> file contains many classes. Each class defines the
position, size, font, color, and background color of a component.
Each child component is added to its parent component, and the style
file of the parent component affects how the child component will be
displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">pm25</span><span class="o">-</span><span class="n">value</span><span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span><span class="n">center</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span><span class="mi">38</span><span class="n">px</span><span class="p">;</span>
    <span class="n">color</span><span class="p">:</span><span class="c1">#f0ffff;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">50</span><span class="n">px</span><span class="p">;</span>
    <span class="n">top</span><span class="p">:</span><span class="mi">275</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">pm25</span><span class="o">-</span><span class="n">name</span><span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span><span class="n">center</span><span class="p">;</span>
    <span class="n">color</span><span class="p">:</span><span class="c1">#a2c4a2;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">50</span><span class="n">px</span><span class="p">;</span>
    <span class="n">top</span><span class="p">:</span><span class="mi">335</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">location</span><span class="o">-</span><span class="n">text</span><span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span><span class="n">center</span><span class="p">;</span>
    <span class="n">color</span><span class="p">:</span><span class="c1">#f0ffff;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">50</span><span class="n">px</span><span class="p">;</span>
    <span class="n">top</span><span class="p">:</span><span class="mi">20</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">container</span><span class="p">{</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">454</span><span class="n">px</span><span class="p">;;</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">circleProgress</span><span class="p">{</span>
    <span class="n">centerX</span><span class="p">:</span><span class="mi">227</span><span class="n">px</span><span class="p">;</span>
    <span class="n">centerY</span><span class="p">:</span><span class="mi">250</span><span class="n">px</span><span class="p">;</span>
    <span class="n">radius</span><span class="p">:</span><span class="mi">180</span><span class="n">px</span><span class="p">;</span>
    <span class="n">startAngle</span><span class="p">:</span><span class="mi">198</span><span class="p">;</span>
    <span class="n">totalAngle</span><span class="p">:</span><span class="mi">320</span><span class="p">;</span>
    <span class="n">strokeWidth</span><span class="p">:</span><span class="mi">45</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">454</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">image</span><span class="p">{</span>
    <span class="n">top</span><span class="p">:</span><span class="mi">390</span><span class="n">px</span><span class="p">;</span>
    <span class="n">left</span><span class="p">:</span><span class="mi">217</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">32</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">32</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">airquality</span><span class="p">{</span>
    <span class="n">top</span><span class="p">:</span><span class="mi">220</span><span class="n">px</span><span class="p">;</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">center</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">454</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">40</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>index.js</strong></p></li>
</ul>
<p>A <strong>.js</strong> file is used to implement interaction logic of your
application. In the <strong>.js</strong> file of the home page, the following
features need to be implemented: dynamic changes of the text content
and progress bar color based on numbers, multiple languages, page
switching, and animation playback.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Import the router module for page switching.
import router from&#39;@system.router&#39;
export default {
    // Define parameters.
    data: {
      textColor1:&#39;#00ff00&#39;,// Text color
      textColor2:&#39;#00ff00&#39;,
      bgColor1:&#39;#669966&#39;,// Background color
      bgColor2:&#39;#669966&#39;,
      swiperPage:0,
      percent1:0,// Progress bar
      percent2:0,
      src1:&#39;common/cloud_green.png&#39;,
      src2:&#39;common/cloud_green.png&#39;,
      airData: [{
        location: &#39;HangZhou&#39;,
        airQuality: &#39;Good&#39;,
        detailData: 10
      }, {
        location: &#39;ShangHai&#39;,
        airQuality: &#39;Unhealth&#39;,
        detailData:90
      }]
    },
    onInit () {
        // Multi-language feature. Use the $t function to obtain content in the required language.
        this.airData[0].location = this.$t(this.airData[0].location);
        this.airData[1].location = this.$t(this.airData[1].location);
        this.airData[0].airQuality = this.$t(this.airData[0].airQuality);
        this.airData[1].airQuality = this.$t(this.airData[1].airQuality);
        if(this.airData[0].detailData &gt; 100){  // Display different colors and images based on indicator values.
            this.src1 = &quot;common/cloud_red.png&quot;;
            this.textColor1 = &#39;#ff0000&#39;;// Display the text in red.
            this.bgColor1 = &#39;#9d7462&#39;;
        } else if(50 &lt; this.airData[0].detailData &amp;&amp;  this.airData[0].detailData &lt;= 100){
            this.src1 = &quot;common/cloud_yellow.png&quot;;
            this.textColor1 = &#39;#ecf19a&#39;;// Display the text in yellow.
            this.bgColor1 = &#39;#9d9d62&#39;;
        }
        if(this.airData[1].detailData &gt; 100){
            this.src2 = &quot;common/cloud_red.png&quot;;
            this.textColor2 = &#39;#ff0000&#39;;
            this.bgColor2 = &#39;#9d7462&#39;;
       } else if(50 &lt; this.airData[1].detailData &amp;&amp; this.airData[1].detailData &lt;= 100){
            this.src2 = &quot;common/cloud_yellow.png&quot;;
            this.textColor2 = &#39;#ecf19a&#39;;
            this.bgColor2 = &#39;#9d9d62&#39;;
      }
      if(this.selectedCityIndex){
           this.swiperPage = this.selectedCityIndex;
      }
    },
    onShow () {  // Processing logic during page display
        var self = this;
         var time = 1000/(self.airData[self.swiperPage].detailData);// Complete animation playback in 1s.
        if(time == 0){
            time = 100;
        }
       // Animation effect of the ring progress bar. Start a timer and change the progress bar at a certain interval (calculated based on the AQI value). The animation playback is completed within 1s.
        var interval = setInterval(function () {
            if ((self.swiperPage==0?self.percent1:self.percent2) &gt;= self.airData[self.swiperPage].detailData) {
                clearInterval(interval);
                return;
            }
            if(self.swiperPage == 0){
                self.percent1++;
            }else{
                self.percent2++
            }
        }, time)
    },
    // Switch to the detail page.
    openDetail () {
      router.replace({
        uri:&#39;pages/detail/detail&#39;,
        params:{selectedCityIndex:this.swiperPage}// Selected city
      });
    },
    // Swiping event, which saves the index value of the current &lt;swiper&gt; and directly switches to the specified &lt;swiper&gt; screen from the details page.
    swiperChange (e) {
        this.swiperPage = e.index;
        var self = this;
        var time = 1000/(self.airData[self.swiperPage].detailData);
        if(time == 0){
            time = 100;
        }
        // Play the animation if the user swipe to the page for the first time.
        var interval = setInterval(function () {
            let percent = (self.swiperPage==0?self.percent1:self.percent2);
            if (percent &gt;= self.airData[self.swiperPage].detailData) {
               clearInterval(interval);
               return;
            }
            if(self.swiperPage==0){
                self.percent1++;
            }else{
                self.percent2++;
            }
        }, time)
    }
}
</pre></div>
</div>
</li>
</ol>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Harmony</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Arul.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/guide/building-the-home-page.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>